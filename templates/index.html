{% extends "base.html" %}

{% block favicon_stylesheet %} {{ super() }} {% endblock %}
{% block title %} {{ super() }} {% endblock %}

{% block body %}
    <div id="project-section">
        {% include "flash_messages.html" %}
        <div class="project-dir-path">
            Project directory: <span class="path">{{ path }}</span>
        </div>
    </div>
    <div id="takeout-section" data-full="{{ 'True' if db else '' }}">
        <div id="all-buttons">
            <div id="takeout-buttons">
                    <button id="takeout-setup-button" class="button">Add Takeout</button>
                    <button id="update-records-button" class="button" {{ 'disabled' if not db else '' }}>
                        Update existing records</button>
                    <button id="takeout-cancel-button" class="button-cancel" disabled>Stop</button>
            </div>
            <button id="visualize-button" class="button" {{ 'disabled' if not db else '' }}>Visualize</button>
            <button id="new-project-button" class="button">New project</button>
        </div>
        <div id="takeout-setup" class="{{ 'hidden' if db else '' }}">
            <form id="takeout-form" class="single-field-form-inputs"
                  action="{{ url_for('records.start_db_process') }}" method="POST">
                <input id="takeout-input" name="takeout-dir" placeholder="Takeout path" required>
                <input class="button" type="submit" value="Start">
            </form>
            <div>
                <p>
                    Enter the path to the watch-history.html files.
                    Will only locate any in the provided path if it points to any of the following:
                </p>
                <ul>
                <li>a single file itself, ex. &lt;root dir&gt;/Takeout/YouTube/history/watch-history.html</li>
                <li>a directory with watch-history file(s). Something may be appended at the
                end of each file name to differentiate between them, e.g. watch-history001.html</li>
                <li>a directory with directories of the download archives, extracted with their archive names, e.g.
                    takeout-20181120T163352Z-001</li>
                </ul>
                <p>
                    The search will become confined to one of these types after the first
                    match, i.e. if a watch-history file is found in the directory that was
                    passed, it'll continue looking for those within the same directory, but not
                    in Takeout directories.
                    Processing will be slightly faster if the files are ordered chronologically.
                </p>
            </div>
        </div>
        <div id="db-progress">
            <div id="progress-bar-container">
                <div id="progress-bar-rectangle">
                    <div id="progress-bar"></div>
                    <div id="progress-bar-text"><span></span></div>
                </div>
            </div>
            <div id="progress-msg"></div>
            <div id="wait-for-db"></div>
            <div id="process-results"></div>
        </div>
    </div>
    {% include "help/takeout_help.html" %}
    <script src="{{ url_for('static', filename='js/manage_takeout.js') }}"></script>
{% endblock %}